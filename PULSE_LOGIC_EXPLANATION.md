# 没入度（Pulse）スコアの算出ロジック解説

現在のスコアは、カメラ映像から得られる**3つの主要な要素**を、重み付けして組み合わせてリアルタイムに算出されています。

---

### 1. 視線 (Gaze) - スコアへの寄与度: 50%

*   **仕組み**:
    MediaPipeが顔のパーツから瞳の位置を特定し、その瞳が画面の中央にどれだけ近いかを計測します。
*   **操作とスコアの関係**:
    *   **スコアが上がる操作**: 画面の中央をまっすぐ見つめている状態。
    *   **スコアが下がる操作**: 視線が画面の端（上下左右）に大きく逸れている状態。

---

### 2. 頭の姿勢 (Head Pose) - スコアへの寄与度: 30%

*   **仕組み**:
    顔の3D的な向きを認識し、頭の傾き（特に上下・左右の角度）を計算します。
*   **操作とスコアの関係**:
    *   **スコアが上がる操作**: 頭がまっすぐ前を向いている状態。
    *   **スコアが下がる操作**: スマートフォンを見るように大きく下を向いたり、横を向いたりしている状態。

---

### 3. 表情 (Facial Expression) - スコアへの寄与度: 20%

*   **仕組み**:
    `Blendshapes` という顔の52種類の微細な動きを読み取ります。特に「眉をひそめる動き (`browDown`)」や「口を固く結ぶ動き (`mouthPress`)」を指標として利用しています。
*   **操作とスコアの関係**:
    *   **スコアが上がる操作**: 軽く眉をひそめる動き。これは「集中している状態」としてポジティブに評価されます。
    *   **スコアが下がる操作**: 口を強く結ぶ動きは、緊張や不快の兆候としてスコアを少し下げます。また、完全に無表情な状態も、集中状態よりは低い評価になります。

---

### 最終的なスコアの決定

上記の3つの要素から算出されたスコア（視線スコア、姿勢スコア、表情スコア）を、それぞれの寄与度（50%, 30%, 20%）で重み付けして合計し、**最終的な没入度スコア**としています。

さらに、スコアが急激に変動するのを防ぐため、常に過去のスコアと平均化する処理（指数移動平均）を行っており、滑らかな数値として表示されるようになっています。
